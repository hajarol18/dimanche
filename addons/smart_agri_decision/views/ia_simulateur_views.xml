<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ======================================== -->
    <!-- SIMULATEUR DE SC√âNARIOS IA AVANC√â -->
    <!-- Test param√®tres climatiques + agricoles -->
    <!-- ======================================== -->

    <!-- VUE SIMULATEUR IA -->
    <record id="view_ia_simulateur_form" model="ir.ui.view">
        <field name="name">smart_agri_ia_simulateur.form</field>
        <field name="model">smart_agri_ia_simulateur</field>
        <field name="arch" type="xml">
            <form string="Simulateur IA - Sc√©narios Agricoles">
                <header>
                    <button name="action_lancer_simulation" type="object" string="üöÄ Lancer Simulation" class="btn-primary"/>
                    <button name="action_sauvegarder_scenario" type="object" string="üíæ Sauvegarder" class="btn-secondary"/>
                    <button name="action_comparer_scenarios" type="object" string="üìä Comparer" class="btn-info"/>
                    <button name="action_export_resultats" type="object" string="üì§ Exporter" class="btn-success"/>
                    <field name="state" widget="statusbar" statusbar_visible="brouillon,simulation_en_cours,termine,valide"/>
                </header>

                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Nom du Sc√©nario de Simulation"/>
                        </h1>
                        <h3>
                            <field name="description" placeholder="Description du sc√©nario"/>
                        </h3>
                    </div>

                    <!-- LIENS AVEC LES DONN√âES R√âELLES -->
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h5>üè≠ Contexte Agricole - Exploitation et Parcelle</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="o_form_label">üè≠ Exploitation *</div>
                                            <field name="exploitation_id" required="1"/>
                                            <small class="text-muted">S√©lectionnez l'exploitation pour cette simulation</small>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="o_form_label">üåæ Parcelle (Optionnel)</div>
                                            <field name="parcelle_id"/>
                                            <small class="text-muted">Parcelle sp√©cifique (optionnel)</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PARAM√àTRES CLIMATIQUES -->
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h5>üåç Param√®tres Climatiques - Sc√©narios IPCC RCP</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üå°Ô∏è Augmentation Temp√©rature (¬∞C)</div>
                                            <field name="augmentation_temperature" widget="float"/>
                                            <small class="text-muted">RCP 2.6: +1.5¬∞C | RCP 4.5: +2.5¬∞C | RCP 8.5: +4.8¬∞C</small>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåßÔ∏è Variation Pr√©cipitations (%)</div>
                                            <field name="variation_precipitations" widget="float"/>
                                            <small class="text-muted">Positif: +humidit√© | N√©gatif: -humidit√©</small>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üí® Vitesse Vent (km/h)</div>
                                            <field name="vitesse_vent" widget="float"/>
                                            <small class="text-muted">Impact sur √©vaporation et stress</small>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">‚òÄÔ∏è Rayonnement Solaire (W/m¬≤)</div>
                                            <field name="rayonnement_solaire" widget="float"/>
                                            <small class="text-muted">Photosynth√®se et stress thermique</small>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåä Humidit√© Relative (%)</div>
                                            <field name="humidite_relative" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üå™Ô∏è Fr√©quence √âv√©nements Extr√™mes</div>
                                            <field name="frequence_evenements_extremes" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üå°Ô∏è Amplitude Thermique (¬∞C)</div>
                                            <field name="amplitude_thermique" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåç Sc√©nario RCP</div>
                                            <field name="scenario_rcp"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PARAM√àTRES AGRICOLES -->
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h5>üå± Param√®tres Agricoles - Conditions Culturales</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üå± Type de Culture</div>
                                            <field name="type_culture"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåø Stade de D√©veloppement</div>
                                            <field name="stade_developpement"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üìÖ Date de Semis</div>
                                            <field name="date_semis" widget="date"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåç Type de Sol</div>
                                            <field name="type_sol"/>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üß™ pH du Sol</div>
                                            <field name="ph_sol" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üíß Capacit√© de R√©tention</div>
                                            <field name="capacite_retention" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåø Densit√© de Plantation</div>
                                            <field name="densite_plantation" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üíß Syst√®me d'Irrigation</div>
                                            <field name="systeme_irrigation"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PARAM√àTRES DE GESTION -->
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <div class="card border-warning">
                                <div class="card-header bg-warning text-white">
                                    <h5>‚öôÔ∏è Param√®tres de Gestion - Interventions Agricoles</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üíß Fr√©quence Irrigation (jours)</div>
                                            <field name="frequence_irrigation" widget="integer"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üíß Dose Irrigation (mm)</div>
                                            <field name="dose_irrigation" widget="float"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåø Fr√©quence Fertilisation (jours)</div>
                                            <field name="frequence_fertilisation" widget="integer"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåø Dose Engrais (kg/ha)</div>
                                            <field name="dose_engrais" widget="float"/>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-3">
                                            <div class="o_form_label">üõ°Ô∏è Protection Phytosanitaire</div>
                                            <field name="protection_phytosanitaire"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üå± Rotation des Cultures</div>
                                            <field name="rotation_cultures"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåø Couverture du Sol</div>
                                            <field name="couverture_sol"/>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="o_form_label">üåç Adaptation Climatique</div>
                                            <field name="adaptation_climatique"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- BOUTON LANCER SIMULATION -->
                    <div class="row mt-4">
                        <div class="col-md-12 text-center">
                            <button name="action_lancer_simulation" type="object" 
                                    string="üöÄ LANCER SIMULATION IA" 
                                    class="btn btn-primary btn-lg" 
                                    style="font-size: 18px; padding: 15px 30px;"/>
                            <p class="mt-2 text-muted">
                                <strong>L'IA analysera tous les param√®tres et g√©n√©rera des pr√©dictions d√©taill√©es</strong>
                            </p>
                        </div>
                    </div>

                                         <!-- R√âSULTATS DE LA SIMULATION -->
                     <div class="row mt-4" invisible="state == 'brouillon' or not rendement_predit">
                         <div class="col-md-12">
                             <div class="card border-info">
                                 <div class="card-header bg-info text-white">
                                     <h5>üìä R√©sultats de la Simulation IA - Pr√©dictions et Recommandations</h5>
                                 </div>
                                <div class="card-body">
                                    <!-- M√âTRIQUES PRINCIPALES -->
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="text-center">
                                                <h4 class="text-success">
                                                    <field name="rendement_predit" widget="float"/> t/ha
                                                </h4>
                                                <small>Rendement Pr√©dit</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-center">
                                                <h4 class="text-info">
                                                    <field name="score_ia" widget="integer"/>%
                                                </h4>
                                                <small>Score IA</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-center">
                                                <h4 class="text-warning">
                                                    <field name="niveau_risque" widget="badge" 
                                                           decoration-success="niveau_risque == 'faible'" 
                                                           decoration-warning="niveau_risque == 'modere'" 
                                                           decoration-danger="niveau_risque == 'eleve'"/>
                                                </h4>
                                                <small>Niveau de Risque</small>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="text-center">
                                                <h4 class="text-primary">
                                                    <field name="confiance" widget="integer"/>%
                                                </h4>
                                                <small>Confiance IA</small>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- D√âTAILS DES R√âSULTATS -->
                                    <div class="row mt-3">
                                        <div class="col-md-6">
                                            <h6>üéØ R√©sultats Principaux</h6>
                                            <p class="text-muted">
                                                <em>Le rendement pr√©dit et le score IA sont affich√©s ci-dessus</em>
                                            </p>
                                        </div>
                                        <div class="col-md-6">
                                            <h6>üí° Recommandations IA</h6>
                                            <p class="text-muted">
                                                <em>Les recommandations seront g√©n√©r√©es lors de la simulation</em>
                                            </p>
                                        </div>
                                    </div>

                                    <!-- SC√âNARIOS COMPARATIFS -->
                                    <div class="row mt-3">
                                        <div class="col-md-4">
                                            <div class="card border-success">
                                                <div class="card-header bg-success text-white">
                                                    <h6>üåû Sc√©nario Optimiste</h6>
                                                </div>
                                                <div class="card-body">
                                                    <p class="text-muted">
                                                        <em>Sc√©nario avec conditions optimales</em>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card border-info">
                                                <div class="card-header bg-info text-white">
                                                    <h6>üåç Sc√©nario R√©aliste</h6>
                                                </div>
                                                <div class="card-body">
                                                    <p class="text-muted">
                                                        <em>Sc√©nario avec conditions moyennes</em>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card border-warning">
                                                <div class="card-header bg-warning text-white">
                                                    <h6>üåßÔ∏è Sc√©nario Pessimiste</h6>
                                                </div>
                                                <div class="card-body">
                                                    <p class="text-muted">
                                                        <em>Sc√©nario avec conditions d√©favorables</em>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                                                         <!-- OPTIMISATIONS RECOMMAND√âES -->
                                     <div class="row mt-3">
                                         <div class="col-md-12">
                                             <h6>‚ö° Optimisations Recommand√©es par l'IA</h6>
                                             <p class="text-muted">
                                                 <em>Les optimisations d√©taill√©es seront affich√©es ici apr√®s l'ex√©cution de la simulation IA.</em>
                                             </p>
                                         </div>
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>

                                                                                   <!-- GRAPHIQUES COMPARATIFS -->
                      <div class="row mt-3" invisible="state == 'brouillon' or not rendement_predit">
                          <div class="col-md-6">
                              <div class="card">
                                  <div class="card-header">
                                      <h6>üìà Comparaison Sc√©narios</h6>
                                  </div>
                                  <div class="card-body">
                                      <p class="text-muted">
                                          <em>Les graphiques de comparaison seront g√©n√©r√©s lors de la simulation</em>
                                      </p>
                                  </div>
                              </div>
                          </div>
                          <div class="col-md-6">
                              <div class="card">
                                  <div class="card-header">
                                      <h6>üåç Impact Climatique</h6>
                                  </div>
                                  <div class="card-body">
                                      <p class="text-muted">
                                          <em>L'analyse d'impact climatique sera affich√©e ici</em>
                                      </p>
                                  </div>
                              </div>
                          </div>
                      </div>
                </sheet>

                                 <!-- Note: Les fonctionnalit√©s de chatter seront ajout√©es dans une version future -->
            </form>
        </field>
    </record>

    <!-- VUE LISTE SIMULATEUR IA -->
    <record id="view_ia_simulateur_list" model="ir.ui.view">
        <field name="name">smart_agri_ia_simulateur.list</field>
        <field name="model">smart_agri_ia_simulateur</field>
        <field name="arch" type="xml">
            <list string="Simulations IA">
                <field name="name"/>
                <field name="scenario_rcp"/>
                <field name="type_culture"/>
                <field name="rendement_predit"/>
                <field name="score_ia" widget="badge" 
                       decoration-success="score_ia &gt;= 80" 
                       decoration-warning="score_ia &gt;= 60" 
                       decoration-danger="score_ia &lt; 60"/>
                <field name="niveau_risque" widget="badge" 
                       decoration-success="niveau_risque == 'faible'" 
                       decoration-warning="niveau_risque == 'modere'" 
                       decoration-danger="niveau_risque == 'eleve'"/>
                <field name="date_creation"/>
                <field name="state"/>
            </list>
        </field>
    </record>

    <!-- ACTION SIMULATEUR IA -->
    <record id="action_ia_simulateur" model="ir.actions.act_window">
        <field name="name">Simulateur IA</field>
        <field name="res_model">smart_agri_ia_simulateur</field>
        <field name="view_mode">list,form</field>
        <field name="view_id" ref="view_ia_simulateur_list"/>
        <field name="context">{'search_default_simulations_recentes': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Cr√©ez votre premi√®re simulation IA !
            </p>
            <p>
                Le simulateur IA vous permet de :
                <ul>
                    <li>üß™ Tester diff√©rents sc√©narios climatiques</li>
                    <li>üå± Simuler l'impact sur les cultures</li>
                    <li>‚ö° Optimiser les param√®tres agricoles</li>
                    <li>üìä Comparer les r√©sultats</li>
                    <li>üéØ Obtenir des recommandations IA</li>
                </ul>
            </p>
        </field>
    </record>

    <!-- Note: Le menu est d√©fini dans main_menu.xml pour √©viter les conflits -->

</odoo>
