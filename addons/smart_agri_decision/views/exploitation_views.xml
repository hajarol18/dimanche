<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- ======================================== -->
        <!-- VUES EXPLOITATION AVEC GESTION DES SURFACES -->
        <!-- ======================================== -->
        
        <!-- Vue liste des exploitations avec indicateurs de surface -->
        <record id="view_smart_agri_exploitation_list" model="ir.ui.view">
            <field name="name">smart.agri.exploitation.list</field>
            <field name="model">smart_agri_exploitation</field>
            <field name="arch" type="xml">
                <list string="Exploitations Agricoles" 
                      decoration-info="state == 'en_creation'"
                      decoration-warning="state == 'inactive'"
                      decoration-success="state == 'active'">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="type_exploitation"/>
                    <field name="surface_totale"/>
                    <field name="surface_parcelles"/>
                    <field name="surface_cultivee"/>
                    <field name="surface_disponible"/>
                    <field name="taux_utilisation" widget="progressbar"/>
                    <field name="niveau_alerte_surface" widget="badge" 
                           decoration-success="niveau_alerte_surface == 'optimal'"
                           decoration-warning="niveau_alerte_surface == 'attention'"
                           decoration-danger="niveau_alerte_surface == 'danger'"/>
                    <field name="nombre_parcelles"/>
                    <field name="region"/>
                    <field name="state"/>
                </list>
            </field>
        </record>
        
        <!-- Vue formulaire des exploitations avec gestion des surfaces -->
        <record id="view_smart_agri_exploitation_form" model="ir.ui.view">
            <field name="name">smart.agri.exploitation.form</field>
            <field name="model">smart_agri_exploitation</field>
            <field name="arch" type="xml">
                <form string="Exploitation Agricole">
                    <header>
                        <field name="state" widget="statusbar" 
                               statusbar_visible="en_creation,active,inactive"/>
                    </header>
                    
                    <sheet>
                        <!-- Informations g√©n√©rales -->
                        <group>
                            <group>
                                <field name="name"/>
                                <field name="code"/>
                                <field name="type_exploitation"/>
                                <field name="description"/>
                            </group>
                            <group>
                                <field name="proprietaire"/>
                                <field name="exploitant"/>
                                <field name="telephone"/>
                                <field name="email"/>
                            </group>
                        </group>
                        
                        <!-- Gestion des surfaces avec indicateurs color√©s -->
                        <group string="üü¢ Gestion des Surfaces" name="gestion_surfaces">
                            <group string="Surfaces Totales">
                                <field name="surface_totale"/>
                                <field name="surface_parcelles" readonly="1"/>
                                <field name="surface_disponible" readonly="1"/>
                            </group>
                            <group string="Utilisation des Surfaces">
                                <field name="surface_cultivee" readonly="1"/>
                                <field name="taux_utilisation" readonly="1" widget="progressbar"/>
                                <field name="niveau_alerte_surface" readonly="1" widget="badge"
                                       decoration-success="niveau_alerte_surface == 'optimal'"
                                       decoration-warning="niveau_alerte_surface == 'attention'"
                                       decoration-danger="niveau_alerte_surface == 'danger'"/>
                            </group>
                        </group>
                        
                        <!-- Localisation -->
                        <group string="üìç Localisation">
                            <group>
                                <field name="adresse"/>
                                <field name="commune"/>
                                <field name="departement"/>
                                <field name="region"/>
                                <field name="code_postal"/>
                            </group>
                            <group>
                                <field name="latitude"/>
                                <field name="longitude"/>
                                <field name="altitude"/>
                                <field name="zone_climatique"/>
                                <field name="type_sol"/>
                            </group>
                        </group>
                        
                        <!-- Onglets pour les donn√©es li√©es -->
                        <notebook>
                            <page string="üèûÔ∏è Parcelles" name="parcelles">
                                <field name="parcelle_ids" context="{'default_exploitation_id': id}">
                                    <list>
                                        <field name="name"/>
                                        <field name="code"/>
                                    </list>
                                </field>
                            </page>
                            
                            <page string="üåæ Cultures" name="cultures">
                                <field name="culture_ids" context="{'default_exploitation_id': id}">
                                    <list>
                                        <field name="name"/>
                                        <field name="code"/>
                                    </list>
                                </field>
                            </page>
                            
                            <page string="üîß Interventions" name="interventions">
                                <field name="intervention_ids" context="{'default_exploitation_id': id}">
                                    <list>
                                        <field name="name"/>
                                    </list>
                                </field>
                            </page>
                            
                            <page string="üìä Intrants" name="intrants">
                                <field name="intrant_ids" context="{'default_exploitation_id': id}">
                                    <list>
                                        <field name="name"/>
                                        <field name="code"/>
                                    </list>
                                </field>
                            </page>
                        </notebook>
                        
                        <!-- Notes -->
                        <group string="üìù Notes">
                            <field name="notes" nolabel="1"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Vue graphique des exploitations par r√©gion -->
        <record id="view_smart_agri_exploitation_graph" model="ir.ui.view">
            <field name="name">smart.agri.exploitation.graph</field>
            <field name="model">smart_agri_exploitation</field>
            <field name="arch" type="xml">
                <graph string="Exploitations par R√©gion" type="bar">
                    <field name="region"/>
                    <field name="surface_totale" type="measure"/>
                </graph>
            </field>
        </record>
        
        <!-- Vue pivot des exploitations -->
        <record id="view_smart_agri_exploitation_pivot" model="ir.ui.view">
            <field name="name">smart.agri.exploitation.pivot</field>
            <field name="model">smart_agri_exploitation</field>
            <field name="arch" type="xml">
                <pivot string="Analyse des Exploitations">
                    <field name="region" type="row"/>
                    <field name="type_exploitation" type="row"/>
                    <field name="surface_totale" type="measure"/>
                    <field name="taux_utilisation" type="measure"/>
                </pivot>
            </field>
        </record>
        
        <!-- Action pour les exploitations -->
        <record id="action_smart_agri_exploitation" model="ir.actions.act_window">
            <field name="name">Exploitations Agricoles</field>
            <field name="res_model">smart_agri_exploitation</field>
            <field name="view_mode">list,form,graph,pivot</field>
            <field name="context">{'search_default_actives': 1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Cr√©ez votre premi√®re exploitation agricole !
                </p>
                <p>
                    Une exploitation agricole repr√©sente une unit√© de production agricole
                    avec ses parcelles, cultures et interventions.
                </p>
            </field>
        </record>
        
        <!-- VUES EMBEDDED COMPL√àTES POUR √âVITER LES PROBL√àMES DE VALIDATION -->
        
        <!-- Vue embedded pour les parcelles -->
        <record id="view_smart_agri_parcelle_embedded" model="ir.ui.view">
            <field name="name">smart.agri.parcelle.embedded</field>
            <field name="model">smart_agri_parcelle</field>
            <field name="arch" type="xml">
                <list>
                    <field name="name"/>
                    <field name="code"/>
                    <field name="surface"/>
                    <field name="type_sol_id"/>
                    <field name="irrigation"/>
                    <field name="drainage"/>
                    <field name="culture_active_id"/>
                </list>
            </field>
        </record>
        
        <!-- Vue embedded pour les cultures -->
        <record id="view_smart_agri_culture_embedded" model="ir.ui.view">
            <field name="name">smart.agri.culture.embedded</field>
            <field name="model">smart_agri_culture</field>
            <field name="arch" type="xml">
                <list editable="bottom">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="parcelle_id"/>
                    <field name="famille"/>
                    <field name="surface_utilisee"/>
                    <field name="state"/>
                    <field name="date_plantation"/>
                    <field name="date_recolte_prevue"/>
                </list>
            </field>
        </record>
        
        <!-- Vue embedded pour les interventions -->
        <record id="view_smart_agri_intervention_embedded" model="ir.ui.view">
            <field name="name">smart.agri.intervention.embedded</field>
            <field name="model">smart_agri_intervention</field>
            <field name="arch" type="xml">
                <list editable="bottom">
                    <field name="name"/>
                    <field name="parcelle_id"/>
                    <field name="culture_id"/>
                    <field name="type_intervention"/>
                    <field name="date_planifiee"/>
                    <field name="state"/>
                </list>
            </field>
        </record>
        
        <!-- Vue embedded pour les intrants -->
        <record id="view_smart_agri_intrant_embedded" model="ir.ui.view">
            <field name="name">smart.agri.intrant.embedded</field>
            <field name="model">smart_agri_intrants</field>
            <field name="arch" type="xml">
                <list editable="bottom">
                    <field name="name"/>
                    <field name="code"/>
                    <field name="categorie_principale"/>
                    <field name="stock_disponible"/>
                    <field name="stock_minimum"/>
                    <field name="prix_unitaire"/>
                </list>
            </field>
        </record>
        

        
    </data>
</odoo>