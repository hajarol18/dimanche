<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- ======================================== -->
        <!-- VUES IMPORT M√âT√âO COMPL√àTES SELON CAHIER DES CHARGES -->
        <!-- ======================================== -->
        
        <!-- Vue liste des imports Meteostat avec indicateurs -->
        <record id="view_meteostat_import_list" model="ir.ui.view">
            <field name="name">smart.agri.meteostat.import.list</field>
            <field name="model">smart_agri_meteostat_import</field>
            <field name="arch" type="xml">
                <list string="Imports M√©t√©o - Donn√©es Climatiques" 
                      decoration-info="state == 'planifie'"
                      decoration-warning="state == 'en_cours'"
                      decoration-success="state == 'termine'"
                      decoration-danger="state == 'erreur'">
                    <field name="name"/>
                    <field name="exploitation_id"/>
                    <field name="station_id"/>
                    <field name="parametres_import"/>
                    <field name="date_debut"/>
                    <field name="date_fin"/>
                    <field name="date_import"/>
                    <field name="state"/>
                    <field name="nombre_enregistrements"/>
                    <field name="import_automatique"/>
                    <field name="frequence_import"/>
                </list>
            </field>
        </record>

        <!-- Vue formulaire compl√®te des imports Meteostat -->
        <record id="view_meteostat_import_form" model="ir.ui.view">
            <field name="name">smart.agri.meteostat.import.form</field>
            <field name="model">smart_agri_meteostat_import</field>
            <field name="arch" type="xml">
                <form string="Import M√©t√©o - Donn√©es Climatiques">
                    <header>
                        <button name="importer_donnees_meteostat" type="object" string="üå§Ô∏è Importer Donn√©es" 
                                class="oe_highlight" 
                                invisible="state in ['en_cours', 'termine']"/>
                        <button name="creer_alertes_climatiques" type="object" string="üö® Cr√©er Alertes" 
                                class="btn-warning"
                                invisible="state != 'termine'"/>
                        <field name="state" widget="statusbar" 
                               statusbar_visible="planifie,en_cours,termine,erreur"/>
                    </header>
                    
                    <sheet>
                        <!-- Informations de base -->
                        <group>
                            <group string="üèûÔ∏è Exploitation">
                                <field name="exploitation_id" required="1" 
                                       context="{'default_state': 'active'}"/>
                                <field name="name"/>
                                <field name="description"/>
                            </group>
                            <group string="üåç Station M√©t√©o">
                                <field name="station_id" required="1"/>
                                <field name="latitude" required="1"/>
                                <field name="longitude" required="1"/>
                            </group>
                        </group>
                        
                        <!-- Configuration de l'import -->
                        <group string="‚öôÔ∏è Configuration Import">
                            <group string="P√©riode d'import">
                                <field name="date_debut" required="1"/>
                                <field name="date_fin" required="1"/>
                                <field name="date_import" readonly="1"/>
                            </group>
                            <group string="Param√®tres m√©t√©o">
                                <field name="parametres_import" required="1"/>
                                <field name="import_automatique"/>
                                <field name="frequence_import" 
                                       invisible="not import_automatique"/>
                                <field name="prochaine_import" 
                                       invisible="not import_automatique"/>
                            </group>
                        </group>
                        
                        <!-- R√©sultats et statistiques -->
                        <group string="üìä R√©sultats Import" 
                               invisible="state == 'planifie'">
                            <group string="Statistiques">
                                <field name="nombre_enregistrements" readonly="1"/>
                                <field name="duree_import" readonly="1"/>
                            </group>
                            <group string="Logs">
                                <field name="erreur_import" readonly="1" 
                                       invisible="state != 'erreur'"/>
                                <field name="log_import" readonly="1" nolabel="1"/>
                            </group>
                        </group>
                        
                        <!-- Notes -->
                        <group string="üìù Notes">
                            <field name="notes" nolabel="1"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        
        <!-- Vue graphique des imports par exploitation -->
        <record id="view_meteostat_import_graph" model="ir.ui.view">
            <field name="name">smart.agri.meteostat.import.graph</field>
            <field name="model">smart_agri_meteostat_import</field>
            <field name="arch" type="xml">
                <graph string="Imports M√©t√©o par Exploitation" type="bar">
                    <field name="exploitation_id"/>
                    <field name="nombre_enregistrements" type="measure"/>
                </graph>
            </field>
        </record>
        
        <!-- Vue pivot des imports m√©t√©o -->
        <record id="view_meteostat_import_pivot" model="ir.ui.view">
            <field name="name">smart.agri.meteostat.import.pivot</field>
            <field name="model">smart_agri_meteostat_import</field>
            <field name="arch" type="xml">
                <pivot string="Analyse des Imports M√©t√©o">
                    <field name="exploitation_id" type="row"/>
                    <field name="parametres_import" type="row"/>
                    <field name="nombre_enregistrements" type="measure"/>
                    <field name="duree_import" type="measure"/>
                </pivot>
            </field>
        </record>
        
        <!-- Action pour les imports Meteostat -->
        <record id="action_meteostat_import" model="ir.actions.act_window">
            <field name="name">üå§Ô∏è Imports M√©t√©o</field>
            <field name="res_model">smart_agri_meteostat_import</field>
            <field name="view_mode">list,form,graph,pivot</field>
            <field name="context">{'default_import_automatique': True}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Cr√©ez votre premier import de donn√©es m√©t√©o !
                </p>
                <p>
                    Importez des donn√©es climatiques depuis Meteostat pour :
                    <br/>‚Ä¢ Surveiller les conditions m√©t√©orologiques
                    <br/>‚Ä¢ Cr√©er des alertes climatiques (s√©cheresse, gel, canicule)
                    <br/>‚Ä¢ Analyser les tendances climatiques
                    <br/>‚Ä¢ Aider √† la d√©cision agricole
                </p>
            </field>
        </record>
        
        <!-- LES MENUS SONT MAINTENANT D√âFINIS DANS menu_meteo_climat.xml -->
        
    </data>
</odoo>